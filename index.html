<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" type="text/css" href="styles.css">
  <title>Unisex Bathroom Search</title>
</head>
<body onload="search()">
  <button onclick="window.location.href = 'https&#58;&#47;&#47;cat-boop.com';">Home</button>
  <div class="grid background">
    <div class="grid-row">
      <div class="grid-item background">
        <h1>Unisex Bathroom Search</h1>
        <div style="margin: 1em;">
          <label for="buildingInput">Enter Building Name:</label>
          <input type="text" id="buildingInput">
        </div>
      </div>
      <div class="grid-item background">
        <h1>About</h1>
        <p>i just want a neat and compiled list i can search to use the bathroom ffs</p>
        <p>Bathroom data is from <a href="https://www.architects.uga.edu/sites/default/files/documents/field/maps/current/unisex-bathrooms.pdf" target="”_blank”">UGA Architects</a>
        (but I had to change/add some data because some is wrong/out of date)</p>
        <p>blah blah not affiliated with UGA Architects or UGA FMD</p>
      </div>
    </div>
    <div class="grid-row">
      <div class="grid-item background">
        <table>
          <th style="width: 350px; text-align: left;">Building</th>
          <th>Rooms</th>
        </table>
        <h2 class="closed" id="no-results">No results found</h2>
        <table id="result"></table>
      </div>
    </div>
    <div class="grid-row">
      <div class="grid-item background">
        <h1>Plans</h1>
        <p>Eventually there'll be a campus map and a building map for each bathroom.
          You'll click on the building number to see where on campus it is and the room number to see where in the building it is.
          I have maps of all the floors as PDFs, I am just trying to work out the best way to show them.</p>
        <p>also sry mobile users for not optimizing it for you</p>
      </div>
    </div>
  </div>
  <script src="./data/data.js"></script>
  <script>

    const input = document.querySelector("input");

    input.addEventListener("input", (e) => {
        search();
    });

    function search() {
        let buildingInput = document.getElementById('buildingInput').value;

        buildingInput = buildingInput.replaceAll(" ", "").toLowerCase();

        searchedBuildings = []
        data.forEach(building => {
            if (building.name.toLowerCase().includes(buildingInput)) {
                searchedBuildings.push(building);
            }
        });

        // idk this makes it work and i'm too lazy to optimize :þ
        // besides, look!  ↓↓  a heart :3
        for (let i = -9; i <3; i++) {
          makeTable(searchedBuildings);
        }

        if (searchedBuildings.length != 0) {
          document.getElementById("no-results").classList.add("closed");
        } else {
          document.getElementById("no-results").classList.remove("closed");
        }
      }
    
    function makeTable(arr) {
      let table = document.getElementById("result");
        // adds to the table
        arr.forEach(building => {
          isInTable = false;
          for (let row of table.rows) {
            if (row.cells[0].textContent === building.name) {
              isInTable = true;
            }
          }
          if (!isInTable) {
            let row = table.insertRow();
            let nameCell = row.insertCell(0);
            let roomsCell = row.insertCell(1);
            nameCell.innerHTML = building.name;
            roomsCell.innerHTML = building.rooms;
          }
        });

        //removes from the table
        for(let row of table.rows) {
          isInJSON = false;
          arr.forEach(building => {
            if(row.cells[0].textContent === building.name) {
              isInJSON = true;
            }
          });
          if (!isInJSON) {
            row.parentNode.removeChild(row);
          }
        }
    }


  
  </script>
</body>
</html>
